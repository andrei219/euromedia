
Disponibles como diferencia ( Apartado A):


SELECT AUX.ID, MANY_MANIES.CREDIT_ID
    FROM (
             SELECT SALE_INVOICES.ID FROM SALE_INVOICES
             INNER JOIN SALE_PROFORMAS ON
             SALE_PROFORMAS.SALE_INVOICE_ID = SALE_INVOICES.ID
             WHERE SALE_PROFORMAS.PARTNER_ID = 1
             AND SALE_PROFORMAS.WAREHOUSE_ID IS NULL) AS AUX
     LEFT OUTER JOIN MANY_MANIES ON AUX.ID = MANY_MANIES.CREDIT_ID;

     

Apartado B):

	1. calcular los totales en sql tal que obtenemos un resultado:
           (ID, total) donde id es el id de la factura no proforma. 
        2. Despeus, aquellos calcular la suma de los fraction
           en many manyes de esos id 
        3. El resultaod seria aquellos id tal que el total > que la 
           mencionada suma. 
       	
Esta query obtiene invoice.id -> total sql:

	SELECT ID, SUM(T)
      	FROM (
              SELECT SALE_INVOICES.ID, PRICE * QUANTITY * ( 1 + TAX / 100) AS T
              FROM SALE_INVOICES INNER JOIN SALE_PROFORMAS
              ON SALE_INVOICES.ID = SALE_PROFORMAS.SALE_INVOICE_ID
              INNER JOIN CREDIT_NOTE_LINES ON
              CREDIT_NOTE_LINES.PROFORMA_ID = SALE_PROFORMAS.ID) AS AUX
	GROUP BY AUX.ID;



